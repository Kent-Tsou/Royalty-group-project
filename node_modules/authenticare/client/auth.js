"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.saveAuthToken = saveAuthToken;
exports.isAuthenticated = isAuthenticated;
exports.getDecodedToken = getDecodedToken;
exports.getEncodedToken = getEncodedToken;
exports.logOff = logOff;

var _jwtDecode = _interopRequireDefault(require("./jwtDecode"));

var _tokenStorage = require("./tokenStorage");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

function saveAuthToken(authToken) {
  (0, _tokenStorage.saveToken)(authToken);
  return (0, _jwtDecode["default"])(authToken);
}

function isAuthenticated() {
  var authToken = (0, _tokenStorage.getToken)();

  if (authToken) {
    var payload = (0, _jwtDecode["default"])(authToken);
    var expiry = payload.exp;

    if (expiry < new Date().getTime() / 1000) {
      logOff();
      return false;
    }

    return true;
  } else {
    return false;
  }
}

function getDecodedToken() {
  var authToken = (0, _tokenStorage.getToken)();
  return authToken ? (0, _jwtDecode["default"])(authToken) : null;
}

function getEncodedToken() {
  return (0, _tokenStorage.getToken)();
}

function logOff() {
  (0, _tokenStorage.saveToken)(null);
}